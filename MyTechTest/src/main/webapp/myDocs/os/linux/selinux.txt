参考：https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/SELinux_Users_and_Administrators_Guide/chap-Security-Enhanced_Linux-Introduction.html
     http://www.cnblogs.com/yang-wu/p/5109843.html
     
discretionary access control（DAC）：自主访问控制
Mandatory Access Control（MAC）：强制访问控制
Access Vector Cache (AVC)：访问向量缓存
Berkeley Internet Name Domain（BIND）

运行selinux的好处：
1、所有的进程（process）和文件（file）都被标记为一个类型（type）。类型（type）定义了一个进程的域（domain），一个文件的类型（type）。进程相互独立的运行在各自的域中，
selinux策略规则定义了进程和文件以及进程和进程之间如何互动。只有selinux策略规则存在并允许他们才能访问。
2、细粒度访问控制。跨越了传统的unix权限控制：用户自由裁量控制和基于linux用户以及组id。selinux访问控制基于所有合法信息：  例如：selinux用户，角色，类型，以及一个可选的level。
3、selinux策略是行政规定，强制为系统级别的，不是有用户决定的。
4、减少特权升级攻击的脆弱性。进程运行在域中，因此彼此隔离。selinux策略规则定义了进程访问文件和其他进程的方式。如果一个进程被攻破，攻击者只能访问该进程的正常功能以及被配置为有权访问的文件。
例如：如果apache http server被攻破，攻击者不能用该进程读取位于用户目录下的文件，除非一个指定的selinux策略规则被添加并配置成允许访问。
5、selinux可以用于加强数据的机密性和完整性，以及保护进程来自于不可信的输入。
然而，selinux并非：
1、杀毒软件
2、密码、防火墙以及其他安全系统的替代品
3、一体化安全解决方案

selinux的目的是加强现有的安全解决方案，而不是取代他们。甚至在运行selinux的时候，继续遵循以下的安全实践也是非常重要的：保持软件更新到最新，使用难以猜测的密码，以及防火墙等等。

下面的例子演示了selinux如何增强安全：
1、默认动作是禁止的。 如果一个selinux策略规则不村子允许访问。那么当一个进程打开文件，访问被禁止了。
2、selinux能够限制linux用户。在selinux策略中存在一些受限的selinux用户。linux用户可以被映射到selinux用户以利用安全规则和机制作用于他们。例如：映射一个linux用户到selinux用户：user_u。
结果是linux用户不能运行（除非单独配置了）设置用户id（setuid）的应用，像sudo和su，也阻止了他们在他们的家目录执行文件和应用。如果配置了，就可以防止用户在家目录执行恶意文件。
3、进程隔离。进程运行在自己的域中，防止了进程利用其它进程访问文件，以及防止进程访问其它进程。例如，除非有另外的配置。攻击者攻破了samba服务器，并不能利用samba服务器作为一个攻击向量
来读取被其它进程使用的文件，例如被mariaDB使用的数据库。
4、selinux可以限制由于配置错误造成的损失。域名系统（DNS）服务彼此之间经常复制信息，作为区域转移。攻击者可以利用区域转移用错误的信息更新DNS服务。当运行Berkeley Internet Name Domain (BIND) 
作为一个DNS服务。即使管理员忘了限制哪个服务器可以执行区域转移，默认的selinux策略防止区域文件被区域转移更新，通过绑定为自己和其他进程。


selinux状态与模式：
有两种状态：启用、禁用。如果禁用了那么只有DAC规则起作用。
如果启用了，selinux就处于下列几种模式中的一种：
Enforcing（强制模式）：selinux会基于selinux策略规则拒绝访问。
Enforcing（宽容模式）：selinux不拒绝访问。但是强制模式拒绝访问的动作都会被记录下来。
[root@centos74 sbin]# getenforce
Permissive
[root@centos74 sbin]# setenforce 1
[root@centos74 sbin]# getenforce
Enforcing








SELinux 全称 Security Enhanced Linux (安全强化 Linux)，是 MAC (Mandatory Access Control，强制访问控制系统)的一个实现，
目的在于明确的指明某个进程可以访问哪些资源(文件、网络端口等)。强制访问控制系统的用途在于增强系统抵御 0-Day 攻击(利用尚未公开的漏洞实现的攻击行为)的能力。
所以它不是网络防火墙或 ACL 的替代品，在用途上也不重复。

了解和配置 SELinux

1. 获取当前 SELinux 运行状态
getenforce
可能返回结果有三种：Enforcing、Permissive 和 Disabled。
Disabled 代表 SELinux 被禁用，Permissive 代表仅记录安全警告但不阻止可疑行为，Enforcing 代表记录警告且阻止可疑行为。

2. 改变 SELinux 运行状态
setenforce [ Enforcing | Permissive | 1 | 0 ]
该命令可以立刻改变 SELinux 运行状态，在 Enforcing 和 Permissive 之间切换，结果保持至关机。
一个典型的用途是看看到底是不是 SELinux 导致某个服务或者程序无法运行。若是在 setenforce 0 之后服务或者程序依然无法运行，
那么就可以肯定不是 SELinux 导致的。

3. SELinux 运行策略
配置文件 /etc/sysconfig/selinux 还包含了 SELinux 运行策略的信息，通过改变变量 SELINUXTYPE的值实现，
该值有两种可能：targeted 代表仅针对预制的几种网络服务和访问请求使用 SELinux 保护，strict 代表所有网络服务和访问请求都要经过 SELinux。
若是想自己编辑 SELinux 策略，也提供了命令行下的策略编辑器 seedit 以及 Eclipse 下的编辑插件 eclipse-slide 。

yum -y install setroubleshoot

